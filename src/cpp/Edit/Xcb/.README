##############################################################################
##
##       Copyright (c) 2020-2021 Frank Eskesen.
##
##       This file is free content, distributed under the MIT license.
##       (See accompanying file LICENSE.MIT or the original contained
##       within https://opensource.org/licenses/MIT)
##
##############################################################################
##
## Title-
##       .README
##
## Purpose-
##       EDITOR README information file.
##
## Last change date-
##       2021/01/24
##
## Implementation notes-
##       This is an EXPERIMENTAL project in PRE-ALPHA status.
##       ALL interfaces are preliminary and subject to major change.
##
##       Find editor usage information, including key bindings, at the end of
##       this document.
##
##       For internal trace type information use: "rgrep trace\("
##
##############################################################################

##############################################################################
## INFO: CYGWIN features not available or not working. (OK on Linux)
         Config::backtrace()        // CYGWIN: no output
         setlocale(LC_NUMERIC, ""); printf("%'d\n", 123456789); // No commas

##############################################################################
## STATUS:
2021/01/24 Xcb subdirectory moved to ~/src/cpp/inc/gui and ~/src/cpp/lib/gui
         Fixed block cut bug.

2021/01/10 BUG: (Not reproduced since 2021/01/10)
         Blank lines intermittently duplicate prior line offset 2 columns
         (Doesn't show up immediately. Moving cursor over line shows it.)
         ** USE F9 DEBUGGING OPTION **
         It looks like data->cursor got changed in an unexplained manner.
         Added .CSR trace event whenever cursor changes to flush it out.

2021/01/16 TODO:
         Some config options not coded yet.
         Implement backward locate; locate with wrap.
         Implement protected file.

         For directories, load the file names. (Protected file)
         Draw full background on line 0 (status, message, history)
         Multiple editor windows. (Restructure required.)
           (May not be too hard. Only one window open a time.)
         Possibly don't need to call mark.handle_redo from file.redo_insert.
           file.redo_insert is called on original insert.
           Isn't mark already done then???

##############################################################################
2021/01/22 Code review. Xcb/Edit now used by author as default editor.

2021/01/16 Block copy/paste operational, but must be done using ctrl-C/ctrl-V

2021/01/10 Restructure. Removed TextWindow, function merged into EdText.

2021/01/03 Bug fix: EdBifs editor::command, data->commit before any command
         lib/pub/Parser.cpp: Data extraction iterator; Allow duplicate lines
         Config.cpp: Configurable screen colors.

2020/12/15 Added built-in edit function with wildcard name resolution.
         Updated pub library (wildcard file name compare)
         EdMark greatly improved.
         Updated ~/src/obj/git from ~/obj/.git
         Other built in functions added or scaffolded.
         Some objects and functions renamed and/or refactored.
         Removed unused test objects. Only EdMisc remains.

2020/12/11 EdMark implemented (Working, needs usage test)

2020/12/09 Moved Xcb/Edit => Edit/Xcb

2020/12/08 Refactored Editor/Config into a single namespace

2020/12/04 Command line handling.

2020/11/12 Fixed Signals, moving it to pub library (ADL issue)

2020/10/15 Debugged xcb_xfixes_hide_cursor not working
         (It's a Cygwin problem. It works properly on native Fedora Linux.)
         Button handlers implemented. (But not command handling.)
         Line and column numbers handled more accurately.

2020/10/12 Editor singleton object available using Editor::editor
         Fixed Active::replace_text (insert_char wasn't working properly)

2020/10/11 Improved UTF8 handling and documentation
         Combining characters are not handled properly; They don't combine.
         Multiple size_t aliases defined for different purposes.
         (This does not prevent mis-use, but does clarify usage.)

2020/10/02 Pixmap is now the base drawable.
         Deferred truetype font implementation.

2020/09/06 Basic editing functions implemented.
         Valid only as quasi-working XCB example program.

2020/09/07 (MORE) Pre-requisite packages
         (Red Hat Fedora) Linux:
         xcb-util-cursor-devel

         Cygwin:
         libxcb-cursor-devel

2020/09/06 Linux pre-requisite packages
         (Nothing new installed: /usr/include/xcb already up to date.)

2020/09/06 Cygwin pre-requisite packages
         libX11-devel                  (probable maintenance update)
            /usr/include/X11/XKBlib.h  [[ NEEDED ]]

         libxcb-devel                  [[ PREREQUISITE ]]
            /usr/include/xcb/xcb.h
            /usr/include/xcb/xproto.h
            /usr/lib/libxcb.dll.a

         libxcb-xfixes-devel           [[ PREREQUISITE ]]
            /usr/include/xcb/xfixes.h
            /usr/lib/libxcb-fixes.dll.a

         [[ Needed, already present ]]
            /usr/include/X11/keysymdef.h

2020/07/19 Started

##############################################################################
## TODO:
2020/09/05 ** EXPERIMENTAL **
         Code review. Completely test all implemented functions.
            ==> Invalid font: Need better user error message
         Multiple windows. (No search, status, command, or message lines)
         File write not implemented.
         Hide system cursor when typing. (Show when moving mouse.)
         Is draw optimization (double buffering) required?

2020/07/28 Xcb/Device base class: Widget or Window?
         Window (at least for now)

2020/07/28 Need to check whether file is a file or a directory.
         If directory, load R/O file list, selectable files/directories

2020/07/28 Background file loader. Synch with EdText

##############################################################################
## DEFERRED:
2020/10/02 Fontconfig / Truetype fonts
         Fontconfig easy enough to use.
         Truetype extremely difficult to use.
             ONE working example found.
             Most documentation is incomplete. That which exists mostly
             recommends using a higher level interface rather than the X11/XCB
             interface. While looking at source code could be an option, it's
             too time consuming.

##############################################################################
## FEATURE:

##############################################################################
## OPEN:

##############################################################################
## CLOSED:

##############################################################################
## FIXED:

##############################################################################
##
## General usage notes:
##     When any line is changed, it is saved with trailing blanks removed.
##     If the last line has no delimiter and is changed, its delimiter is
##     changed to '\n' or "\r\n" depending upon the file mode.
##
##     Copy and move operations (Alt-C and Alt-M) are divided in two. The
##     first part copies the lines into a work area, then (for move) deleting
##     deleting the original lines. The second part pastes the lines. The
##     paste operation can be repeated using Ctrl-V. For move, UNDO is also
##     two operations. Once created, the copy list is only replaced. It is
##     never deleted.
##
## Editor commands: (Command names are not case sensitive)
##     BOT     Move the cursor to the last editor line (column 0)
##     C       Change: C /find/replace/  (Find begins at CURRENT cursor)
##     D       *TEMPORARY* Debug <option>
##     DEBUG   (Alias of D)
##     E       Edit another set of files (Path cannot contain wildcards)
##     EDIT    (Alias of E)
##     FILE    Save and close the current file
##     L       Locate: L /find/ (Find begins at NEXT character)
##     QUIT    (Unconditionally) close the current file
##     SAVE    Save the current file
##     TOP     Move the cursor to the first editor line (column 0)
##
##     Other planned commands may be scaffolded and do nothing.
##
## Editor key bindings:
##     Alt-B   Mark block (Columns)
##     Alt-C   Copy marked lines (Use Ctrl-C + Ctrl-V for block copy)
##     Alt-D   Delete marked lines or block
##     Alt-I   Insert line
##     Alt-L   Mark line
##     Alt-M   Move marked lines (Use Ctrl-X + Ctrl-V for block move)
##     Alt-Q   (Safe) quit. Leave editor if no files are changed.
##     Alt-U   Undo mark
##
##     Ctrl-C  Copy mark  (First half of Alt-C)
##     Ctrl-V  Paste copy (Second half of Alt-C or Alt-M)
##     Ctrl-X  Delete mark (Same as Alt-D)
##
##     ESC     Switch between command and data mode
##     F1      Help message (to stdout)
##     F2      *TEMPORARY* (Bringup test)
##     F3      (Safe) quit. Close file if it's unchanged.
##     F4      Move focus to next changed file
##     F5      Repeat locate
##     F6      Repeat change
##     F7      Move focus to previous file
##     F8      Move focus to next file
##     F9      *TEMPORARY* (Debug everything, turn off/on internal trace)
##     F10     Move current line to top of screen
##     F11     UNDO (Note: Cannot UNDO a save operation)
##     F12     REDO (Note: Any committed change after UNDO removes REDO)
##
##############################################################################
